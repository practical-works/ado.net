--*=======================================================================================*--
-- ♦ MyADO ~ Base de données expérimentale
--*=======================================================================================*-
drop database #MyADO;
create database #MyADO;
use #MyADO;

--*=======================================================================================*--
--♦ Créer les tables
--*=======================================================================================*--
create table Joueur (
	id int primary key identity(1,1),
	nom varchar(50) unique not null,
	pass varchar(50) not null,
	clé bigint unique
);
create table Partie (
	num int primary key,
	mode varchar(50),
	dat datetime,
	deg decimal identity (0,10)
);
create table Jouer (
	id_joueur int foreign key references Joueur (id) on delete cascade on update cascade,
	num_partie int foreign key references Partie (num) on delete cascade on update cascade,
	score int,
	primary key (id_joueur, num_partie)
);
--PS. Il n'est autorisé qu'une seule colonne identité par table !

--*=======================================================================================*--
--♦ Remplir les tables
--*=======================================================================================*--
insert into Joueur values
('ExtremeJutsu', 'leesin272', null),('EiDiSi', 'riven115', 115165),
('Dinamene Laface', 'jinx162', 162498),('Nefertiti', 'sona259', 259546),
('Remilks', 'vayne38', 38566),('Fallen Devip', 'gracas82', 82457),
('Fallen Demôn', 'lux68', 68292),('Fallen Luciferr', 'lucian141', 141922),
('Heisenberg02', 'shaco242', 242620),('veen1', 'gangplank200', 200429);
insert into Partie values
(1, 'Normal', '10-06-2015'),(2, 'Normal Draft', '22-07-2015'),
(3, 'Normal', '07-10-2015'),(4, 'Ranked', '27-11-2015'),
(5, 'Normal', '02-01-2016'),(6, 'Ranked Flex', '09-03-2016'),
(7, 'Ranked', '22-05-2016'),(8, 'Normal Draft', '29-07-2016'),
(9, 'Ranked Flex', '10-08-2016'),(10, 'Normal', '31-12-2016');
insert into Jouer values
(1, 1, null),(2, 1, null),(3, 1, null),(4, 1, null),(5, 1, null),
(6, 2, null),(7, 2, null),(8, 2, null),(9, 2, null),(10, 3, null),
(3, 4, null),(2, 5, null),(10, 6, null),(8, 7, null),(8, 9, null),
(1, 10, null);

--*=======================================================================================*--
--♦ Afficher les noms des tables
--*=======================================================================================*--
select TABLE_NAME from INFORMATION_SCHEMA.TABLES;

--*=======================================================================================*--
--♦ Afficher les tables
--*=======================================================================================*--
create proc SP_AfficherTable @NomTable varchar(max)
as exec ('select * from ' + @NomTable);
--*---------------------------------------------------------------------------------------*--
exec SP_AfficherTable 'Joueur';
exec SP_AfficherTable 'Partie';
exec SP_AfficherTable 'Jouer';
--*---------------------------------------------------------------------------------------*--
select row_number() over (order by id asc) as Indice, * from Joueur;
--*---------------------------------------------------------------------------------------*--

--*=======================================================================================*--
--♦ Jointure globale
--*=======================================================================================*--
select nom, pass, clé, num_partie, mode, dat, score from Jouer 
inner join Joueur on Joueur.id = Jouer.id_joueur
inner join Partie on Partie.num = Jouer.num_partie;
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--

--*=======================================================================================*--
--♦ Something
--*=======================================================================================*--
select 'something' as something;
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--

--*=======================================================================================*--
--♦ Something
--*=======================================================================================*--
select 'something' as something;
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--

--*=======================================================================================*--
--♦ Something
--*=======================================================================================*--
select 'something' as something;
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--

--*=======================================================================================*--
--♦ Something
--*=======================================================================================*--
select 'something' as something;
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
--*---------------------------------------------------------------------------------------*--
